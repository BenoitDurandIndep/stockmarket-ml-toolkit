-- DATASET definition

CREATE TABLE `DATASET` (
  `SK_DATASET` INTEGER PRIMARY KEY AUTOINCREMENT,
  `NAME` TEXT,
  `START_DATE` DATETIME,
  `END_DATE` DATETIME,
  `FILE_NAME` TEXT,
  `DESCRIPTION` TEXT
);

-- SYMBOL definition

CREATE TABLE "SYMBOL" (
  SK_SYMBOL INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  CODE TEXT,
  NAME TEXT,
  TYPE TEXT,
  REGION TEXT,
  CURRENCY TEXT,
  COMMENT TEXT,
  CODE_ALPHA TEXT,
  CODE_YAHOO TEXT,
  CODE_ISIN TEXT
, ACTIVE INTEGER DEFAULT (1), TRADABLE INTEGER DEFAULT (1));

-- "INDICATOR" definition

CREATE TABLE `INDICATOR` (
  `SK_INDICATOR` INTEGER PRIMARY KEY AUTOINCREMENT,
  `NAME` TEXT,
  `LABEL` TEXT,
  `CODE` TEXT,
  `TYPE` INTEGER DEFAULT NULL -- 0 intermediate 1 feature 2 label
);

-- MODEL definition

CREATE TABLE `MODEL` (
  `SK_MODEL` INTEGER PRIMARY KEY AUTOINCREMENT,
  `SK_DATASET` INTEGER NOT NULL DEFAULT 0,
  `SK_SYMBOL` INTEGER NOT NULL DEFAULT 0,
  `SK_LABEL` INTEGER NOT NULL DEFAULT 0,
  `ALGO` TEXT,
  `NAME` TEXT,
  `COMMENT` TEXT,
  `HEADER_DTS` TEXT
);

-- DS_CONTENT definition

CREATE TABLE `DS_CONTENT` (
  `SK_DS_CONTENT` INTEGER PRIMARY KEY AUTOINCREMENT,
  `SK_DATASET` INTEGER NOT NULL DEFAULT 0,
  `SK_SYMBOL` INTEGER NOT NULL DEFAULT 0,
  `SK_INDICATOR` INTEGER NOT NULL DEFAULT 0,
  FOREIGN KEY (`SK_DATASET`) REFERENCES `DATASET`(`SK_DATASET`)
);

-- DS_FILTERED definition

CREATE TABLE `DS_FILTERED` (
  `SK_DS_FILTERED` INTEGER PRIMARY KEY AUTOINCREMENT,
  `SK_MODEL` INTEGER NOT NULL DEFAULT 0,
  `SK_INDICATOR` INTEGER NOT NULL DEFAULT 0
);

-- CAMPAIGN definition

CREATE TABLE CAMPAIGN (
	SK_CAMPAIGN INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	CODE TEXT(50),
	DESCRIPTION TEXT(255),
	FILENAME TEXT(100),
	ACTIVE INTEGER,
	SETTINGS TEXT(255),
	INITIAL_CASH INTEGER,
	COMMISSION NUMERIC,
	DATE_START TEXT(25),
	DATE_END TEXT(25)
);

-- STRATEGY definition

CREATE TABLE STRATEGY (
	SK_STRATEGY INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	NAME TEXT(100),
	STRAT_TYPE TEXT(100),
	MODEL_TYPE TEXT(100),
	DESCRIPTION TEXT(255),
	SETTINGS TEXT DEFAULT ('255')
);


-- COMBI_MODELS definition

CREATE TABLE COMBI_MODELS (
	SK_COMBI_MODELS INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	SK_MODEL INTEGER NOT NULL,
	SK_STRATEGY INTEGER NOT NULL
);

-- SCENARIO definition

CREATE TABLE SCENARIO (
	SK_SCENARIO INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	SK_CAMPAIGN INTEGER,
	SK_STRATEGY INTEGER,
	SETTINGS TEXT(255),
	COMMENT TEXT(255)
);

-- BT_RESULT definition

CREATE TABLE BT_RESULT (
	SK_BT_RESULT INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	SK_SCENARIO INTEGER,
	SK_SYMBOL INTEGER,
	DATE_START TEXT,
	DATE_END TEXT,
	UNIT_TIME TEXT,
	INTIAL_CASH INTEGER,
	FINAL_CASH INTEGER,
	PROFIT INTEGER,
	NB_TRADES INTEGER,
	MAX_PCT_DRAWDOWN NUMERIC,
	MAX_VAL_DRAWDOWN INTEGER,
	DATE_TEST TEXT,
	NB_SELLS INTEGER,
	NB_WINS INTEGER,
	NB_LOSSES INTEGER,
	NB_WIN_STREAK INTEGER,
	NB_LOSS_STREAK INTEGER,
	TOTAL_COMMISSION NUMERIC,
	SHARPE_RATIO NUMERIC,
	CALMAR_RATIO NUMERIC,
	AVG_TRADE_RETURN NUMERIC
);